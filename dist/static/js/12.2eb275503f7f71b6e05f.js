webpackJsonp([12],{L6nu:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("woOf"),i=a.n(s),n=a("gRE1"),o=a.n(n),l=a("Xxa5"),r=a.n(l),c=a("exGp"),d=a.n(c),p=a("0Mti"),v={name:"TeacherInfo",data:function(){return{personObj:{name:"",mobile:"",loginName:"",pwd:"",teachJob:"",roleIds:[],email:"",joinTime:"",bornTime:"",gender:"",imgName:"",jobTitle:"",wechat:"",qq:""},postImgUrl:"/edu/teach/uploadImg",roleList:[],accessToken:"",fileImgUrl:"",warningText:"",validate:{name:{isOK:!0,text:"请填写姓名"},mobile:{isOK:!0,text:""},teachJob:{isOK:!0,text:"请填写职务"},roleIds:{isOK:!0,text:"请选择角色"},pwd:{isOK:!0,text:"请输入6到12位字母或数字"},email:{isOK:!0,text:""},gender:{isOK:!0,text:"请选择性别"},qq:{isOK:!0,text:"填写QQ号有误"}},img_api:p.a.img_api}},methods:{goBack:function(){this.$router.push({path:"TeacherManage"})},handleAvatarSuccess:function(e,t){1e3==e.code&&(this.fileImgUrl=URL.createObjectURL(t.raw),this.personObj.imgName=e.data.imgName)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type||"image/gif"===e.type,a=e.size/1024/1024<2;return t||this.dialog("请上传正确的图片格式!"),a||this.dialog("上传头像图片大小不能超过 2MB!"),t&&a},generateFun:function(){var e=this;return d()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.getGenerPwd();case 2:1e3===(a=t.sent).code&&(e.personObj.pwd=a.data.password,console.log("MD5：",e.$md5(e.personObj.pwd).toUpperCase()));case 4:case"end":return t.stop()}},t,e)}))()},check:function(){var e=this.personObj;e.name?this.validate.name.isOK=!0:(this.validate.name.isOK=!1,this.validate.name.text="请填写姓名"),e.mobile?/^1\d{10}$/.test(e.mobile)?this.validate.mobile.isOK=!0:(this.validate.mobile.isOK=!1,this.validate.mobile.text="填写手机号码有误"):(this.validate.mobile.isOK=!1,this.validate.mobile.text="请填写手机号码"),/^[a-zA-Z\d]{6,12}$/.test(e.pwd)||this.teachId?this.validate.pwd.isOK=!0:this.validate.pwd.isOK=!1,e.teachJob?this.validate.teachJob.isOK=!0:this.validate.teachJob.isOK=!1,0==e.roleIds.length?this.validate.roleIds.isOK=!1:this.validate.roleIds.isOK=!0,e.gender?this.validate.gender.isOK=!0:this.validate.gender.isOK=!1,e.email?this.validate.email.isOK=!0:(this.validate.email.isOK=!1,this.validate.email.text="请填写邮箱"),/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(e.email)?this.validate.email.isOK=!0:(this.validate.email.isOK=!1,this.validate.email.text="填写邮箱有误"),e.qq?/^[1-9][0-9]{4,10}$/.test(e.qq)?this.validate.qq.isOK=!0:this.validate.qq.isOK=!1:this.validate.qq.isOK=!0},save:function(){var e=this;return d()(r.a.mark(function t(){var a,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.check(),!o()(e.validate).every(function(e){return e.isOK})){t.next=12;break}return(a=i()({},e.personObj)).roleIds=a.roleIds.toString(),a.pwd=a.pwd?e.$md5(a.pwd).toUpperCase():"",a.joinTime=e.dayjs(a.joinTime).format("YYYY-MM-DD"),a.bornTime=e.dayjs(a.bornTime).format("YYYY-MM-DD"),e.teachId&&(a.teachId=e.teachId,delete a.loginName),t.next=10,e.$axios.getTeacherEdit(a);case 10:1e3==(s=t.sent).code?(e.teachId=s.data.teachId||e.teachId,e.successMsg("操作成功"),e.$router.push({path:"/TeacherManage"})):e.dialog(s.message);case 12:case"end":return t.stop()}},t,e)}))()},getRoleList:function(){var e=this;return d()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.getRoleList();case 2:1e3===(a=t.sent).code&&(e.roleList=a.data);case 4:case"end":return t.stop()}},t,e)}))()},getDetail:function(){var e=this;return d()(r.a.mark(function t(){var a,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={teachId:e.teachId},t.next=3,e.$axios.getTeacherDetail(a);case 3:s=t.sent,console.log(s.data),e.personObj.qq=s.data.qq,e.personObj.gender=s.data.gender,e.personObj.joinTime=s.data.joinTime,e.personObj.jobTitle=s.data.jobTitle,e.personObj.mobile=s.data.mobile,e.personObj.wechat=s.data.wechat,e.personObj.imgName=s.data.imgName,e.personObj.bornTime=s.data.bornTime,e.personObj.roleIds=s.data.roleIds?s.data.roleIds.split(","):[],e.personObj.name=s.data.name,e.personObj.roleNames=s.data.roleNames,e.personObj.teachJob=s.data.job,e.personObj.email=s.data.email,e.fileImgUrl=e.img_api+e.personObj.imgName;case 19:case"end":return t.stop()}},t,e)}))()}},created:function(){window.scrollTo(0,0),this.$route.query.teachId&&(this.teachId=this.$route.query.teachId,this.getDetail()),this.getRoleList()},mounted:function(){this.accessToken=localStorage.getItem("accessToken")},watch:{"personObj.mobile":function(e){this.personObj.loginName=e}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"teacher-info"},[a("Header",{attrs:{title:"个人资料"},on:{goBack:e.goBack}}),a("div",{staticClass:"container"},[e._m(0),a("ul",[a("li",[e._m(1),a("div",{staticClass:"content"},[a("el-input",{on:{input:e.check},model:{value:e.personObj.name,callback:function(t){e.$set(e.personObj,"name",t)},expression:"personObj.name"}}),e.validate.name.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.name.text))])],1)]),a("li",[e._m(2),a("div",{staticClass:"content"},[a("el-input",{attrs:{maxlength:"11"},on:{input:e.check},model:{value:e.personObj.mobile,callback:function(t){e.$set(e.personObj,"mobile",t)},expression:"personObj.mobile"}}),e.validate.mobile.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.mobile.text))])],1)]),a("li",[e._m(3),a("div",{staticClass:"content"},[a("el-input",{attrs:{disabled:!0},model:{value:e.personObj.loginName,callback:function(t){e.$set(e.personObj,"loginName",t)},expression:"personObj.loginName"}})],1)]),a("li",[e._m(4),a("div",{staticClass:"content"},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"密码"},on:{input:e.check},model:{value:e.personObj.pwd,callback:function(t){e.$set(e.personObj,"pwd",t)},expression:"personObj.pwd"}}),e.validate.pwd.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.pwd.text))]),a("span",{staticClass:"generate",on:{click:e.generateFun}},[e._v("自动生成")])],1)]),a("li",[e._m(5),a("div",{staticClass:"content"},[a("el-input",{on:{input:e.check},model:{value:e.personObj.teachJob,callback:function(t){e.$set(e.personObj,"teachJob",t)},expression:"personObj.teachJob"}}),e.validate.teachJob.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.teachJob.text))])],1)]),a("li",[e._m(6),a("div",{staticClass:"content"},[a("el-checkbox-group",{on:{change:e.check},model:{value:e.personObj.roleIds,callback:function(t){e.$set(e.personObj,"roleIds",t)},expression:"personObj.roleIds"}},e._l(e.roleList,function(t){return t.isDefault?e._e():a("el-checkbox",{key:t.roleId,staticClass:"role-checkbox",attrs:{label:t.roleId}},[e._v(e._s(t.roleName))])})),e.validate.roleIds.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.roleIds.text))])],1)]),a("li",[e._m(7),a("div",{staticClass:"content"},[a("el-input",{on:{input:e.check},model:{value:e.personObj.email,callback:function(t){e.$set(e.personObj,"email",t)},expression:"personObj.email"}}),e.validate.email.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.email.text))])],1)]),a("li",[a("div",{staticClass:"attribute"},[e._v("入职时间")]),a("div",{staticClass:"content"},[a("el-date-picker",{attrs:{placeholder:"选择日期",type:"date",format:"yyyy-MM-dd"},model:{value:e.personObj.joinTime,callback:function(t){e.$set(e.personObj,"joinTime",t)},expression:"personObj.joinTime"}})],1)]),a("li",[a("div",{staticClass:"attribute"},[e._v("出生年月")]),a("div",{staticClass:"content"},[a("el-date-picker",{attrs:{placeholder:"选择日期",type:"date",format:"yyyy-MM-dd"},model:{value:e.personObj.bornTime,callback:function(t){e.$set(e.personObj,"bornTime",t)},expression:"personObj.bornTime"}})],1)]),a("li",[e._m(8),a("div",{staticClass:"content"},[a("el-radio-group",{on:{change:e.check},model:{value:e.personObj.gender,callback:function(t){e.$set(e.personObj,"gender",t)},expression:"personObj.gender"}},[a("el-radio",{attrs:{label:"m"}},[e._v("男")]),e._v(" "),a("el-radio",{attrs:{label:"f"}},[e._v("女")])],1),e.validate.gender.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.gender.text))])],1)]),e.hasQx("teach:uploadImg")?a("li",[a("div",{staticClass:"attribute"},[e._v("照片")]),a("div",{staticClass:"content",style:{width:"110px",height:"110px"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{name:"imgFile",headers:{accessToken:this.accessToken},action:e.postImgUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess,data:{imgType:0},"before-upload":e.beforeAvatarUpload}},[e.personObj.imgName?a("img",{staticClass:"avatar",attrs:{src:e.fileImgUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.personObj.imgName,expression:"personObj.imgName"}],attrs:{type:"hidden",value:""},domProps:{value:e.personObj.imgName},on:{input:function(t){t.target.composing||e.$set(e.personObj,"imgName",t.target.value)}}}),e.personObj.imgName?e._e():a("span",{staticClass:"addTip"},[e._v("请上传一张清晰的个人照片 "),a("br"),e._v("大小不超过2M")])],1)]):e._e(),a("li",[a("div",{staticClass:"attribute"},[e._v("职称")]),a("div",{staticClass:"content"},[a("el-input",{model:{value:e.personObj.jobTitle,callback:function(t){e.$set(e.personObj,"jobTitle",t)},expression:"personObj.jobTitle"}})],1)]),a("li",[a("div",{staticClass:"attribute"},[e._v("微信号")]),a("div",{staticClass:"content"},[a("el-input",{model:{value:e.personObj.wechat,callback:function(t){e.$set(e.personObj,"wechat",t)},expression:"personObj.wechat"}})],1)]),a("li",[a("div",{staticClass:"attribute"},[e._v("QQ")]),a("div",{staticClass:"content"},[a("el-input",{on:{input:e.check},model:{value:e.personObj.qq,callback:function(t){e.$set(e.personObj,"qq",t)},expression:"personObj.qq"}}),e.validate.qq.isOK?e._e():a("span",{staticClass:"validate"},[e._v(e._s(e.validate.qq.text))])],1)])]),e.hasQx("teach:editStu")?a("FixedButton",{attrs:{buttonText:"保存"},on:{listenToChildEvent:function(t){e.save()}}}):e._e()],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("nav",[t("span",{staticClass:"left"},[this._v("基本信息")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("姓名"),t("i",[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("手机号码"),t("i",[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("登录帐号"),t("i",[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("密码"),t("i",[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("职务"),t("i",[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("角色"),t("i",[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("邮箱"),t("i",[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"attribute"},[this._v("性别"),t("i",[this._v("*")])])}]};var u=a("VU/8")(v,m,!1,function(e){a("jite")},null,null);t.default=u.exports},jite:function(e,t){}});