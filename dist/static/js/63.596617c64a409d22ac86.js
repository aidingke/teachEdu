webpackJsonp([63],{Q1eC:function(t,s){},hxCc:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a("Xxa5"),i=a.n(e),n=a("exGp"),c=a.n(n),o={name:"TeachPass",data:function(){return{typeTitle:"考核",status:"",token:"",tabValue:1,nameNumber:4,questType:2,examType:0,countNumsM:"",countNumsS:"",resData:[]}},methods:{goBack:function(){this.$router.push({path:"/TrainExamIndex"}),sessionStorage.setItem("tabValueTPass","")},updateTabValue:function(t){this.tabValue=t,sessionStorage.setItem("tabValueTPass",this.tabValue),this.getList()},addTestPaper:function(){this.$router.push({path:"./AddTestPaper?questType="+this.questType})},getList:function(){var t=this;return c()(i.a.mark(function s(){var a,e,n,c,o,l;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(0!=t.status){s.next=8;break}return a={pageNo:1,pageSize:100,examType:t.tabValue-1},s.next=4,t.$axios.getExamList(a);case 4:1e3===(e=s.sent).code?(t.resData=e.data,t.resData.forEach(function(s,a){s.startTime=t.dayjs(s.startTime).format("YYYY-MM-DD HH:mm").toString(),s.endTime=t.dayjs(s.endTime).format("HH:mm").toString()})):1100===e.code&&(t.resData=""),s.next=15;break;case 8:if(1!=t.status){s.next=15;break}return n={status:t.tabValue-1,pageNum:1,pageSize:100},s.next=12,t.$axios.getExamEduList(n);case 12:c=s.sent,o="",1e3===c.code&&(t.resData=c.data,t.resData.forEach(function(s,a){s.startTime=t.dayjs(s.startTime).format("YYYY-MM-DD HH:mm").toString(),s.endTime=t.dayjs(s.endTime).format("HH:mm").toString(),0==a&&(o=s.startTime)}),0==n.status&&(l=t.countTime(new Date,new Date(o)),t.countFun(l)));case 15:case"end":return s.stop()}},s,t)}))()},countTime:function(t,s){var a=s.getTime()-t.getTime(),e=(Math.floor(a/864e5),a%864e5),i=e%36e5,n=i%6e4;return 3600*Math.floor(e/36e5)+60*Math.floor(i/6e4)+Math.round(n/1e3)},countFun:function(t){var s=this,a=window.setInterval(function(){t--,1==Number(t)&&(s.dialog("考试开始，请刷新页面"),s.$router.push({path:"/teachPass"}),window.clearInterval(a),s.countNumsFlg=!1);Math.floor(t/86400);var e=t%86400,i=(Math.floor(e/3600),e%3600),n=Math.floor(i/60),c=i%60,o=Math.round(c);s.countNumsM=n,s.countNumsS=o},1e3)},downloadResult:function(t,s,a){var e=this;return c()(i.a.mark(function n(){var c,o,l,u;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return c={questBankId:t,classId:s},i.next=3,e.$axios.exportExamResult(c);case 3:if(o=i.sent){i.next=6;break}return i.abrupt("return");case 6:l=window.URL.createObjectURL(new Blob([o])),(u=document.createElement("a")).style.display="none",u.href=l,u.setAttribute("download",a+"考试成绩.xls"),document.body.appendChild(u),u.click(),u.parentNode.removeChild(u);case 14:case"end":return i.stop()}},n,e)}))()}},mounted:function(){this.tabValue=Number(sessionStorage.getItem("tabValueTPass"))||1,0==localStorage.getItem("userType")?(this.nameNumber=4,this.status=0,this.token=localStorage.getItem("accessToken"),null===this.token&&this.$router.push({path:"/Login"})):1==localStorage.getItem("userType")?(this.nameNumber=1,this.status=1,this.token=localStorage.getItem("accessToken")):(this.status="",this.token=""),this.getList()}},l={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"TeachPass"},[a("Header",{attrs:{title:t.typeTitle},on:{goBack:t.goBack}}),t._v(" "),0===t.status?a("div",{staticClass:"tab-cont"},[a("div",{staticClass:"tab",class:1==t.tabValue?"on":"",on:{click:function(s){t.updateTabValue(1)}}},[t._v("待批卷"),a("i",{staticClass:"line"})]),t._v(" "),a("div",{staticClass:"tab",class:2==t.tabValue?"on":"",on:{click:function(s){t.updateTabValue(2)}}},[t._v("批卷完成"),a("i",{staticClass:"line"})])]):t._e(),t._v(" "),1===t.status?a("div",{staticClass:"tab-cont"},[a("div",{staticClass:"tab",class:1==t.tabValue?"on":"",on:{click:function(s){t.updateTabValue(1)}}},[t._v("待考核"),a("i",{staticClass:"line"})]),t._v(" "),a("div",{staticClass:"tab",class:2==t.tabValue?"on":"",on:{click:function(s){t.updateTabValue(2)}}},[t._v("进行中"),a("i",{staticClass:"line"})]),t._v(" "),a("div",{staticClass:"tab",class:3==t.tabValue?"on":"",on:{click:function(s){t.updateTabValue(3)}}},[t._v("考核完成"),a("i",{staticClass:"line"})])]):t._e(),t._v(" "),a("div",{staticClass:"TeachPassBox",attrs:{id:"WaitPass"}},[t._l(t.resData,function(s,e){return a("div",{key:e,staticClass:"selectBox"},[0===t.status?a("div",{staticClass:"passBox"},[1===t.tabValue?[a("router-link",{attrs:{to:"/TeachPaperDetail?qbId="+s.questBankId+"&questType="+t.questType}},[a("h3",{staticClass:"head"},[t._v(t._s(s.examName))]),t._v(" "),a("p",{staticClass:"comCol"},[t._v(t._s(s.examTime))]),t._v(" "),a("p",{staticClass:"ctit"},[t._v(t._s(s.examDesc))])]),t._v(" "),2==s.examStatus?a("div",{staticClass:"kaoshiBtn"},[a("button",{staticClass:"default",staticStyle:{width:"100%",color:"#ddd"},attrs:{disabled:"disabled"}},[t._v("\n\t\t\t\t\t\t\t\t尚未开始\n\t\t\t\t\t\t\t")])]):t._e(),t._v(" "),2!=s.examStatus?a("div",{staticClass:"kaoshiBtn"},[0==s.stuNum?[t._m(0,!0)]:t._e(),t._v(" "),0!=s.stuNum?[a("router-link",{attrs:{to:"/TeachPassDetails?qbId="+s.questBankId+"&questType="+t.questType}},[a("span",{staticClass:"default"},[t._v("\n\t\t\t\t\t\t\t\t\t\t详情\n\t\t\t\t\t\t\t\t\t")])])]:t._e()],2):t._e()]:t._e(),t._v(" "),2===t.tabValue?[a("router-link",{attrs:{to:"/TeachPassDetails?qbId="+s.questBankId+"&questType="+t.questType}},[a("h3",{staticClass:"head"},[t._v(t._s(s.examName))]),t._v(" "),a("p",{staticClass:"comCol"},[t._v(t._s(s.examTime))]),t._v(" "),a("p",{staticClass:"ctit"},[t._v(t._s(s.examDesc))]),t._v(" "),t.hasQx("teach:exam:exportExcel")?a("div",{staticClass:"kaoshiBtn"},[a("span",{staticClass:"default",on:{click:function(a){a.stopPropagation(),a.preventDefault(),t.downloadResult(s.questBankId,s.classId,s.examName)}}},[t._v("\n\t\t\t\t\t\t\t\t\t导出考试成绩\n\t\t\t\t\t\t\t\t")])]):t._e()])]:t._e()],2):t._e(),t._v(" "),1===t.status?a("div",{staticClass:"passBox"},[1===t.tabValue?[a("div",[a("h3",{staticClass:"head"},[t._v(t._s(s.qbTitle))]),t._v(" "),a("p",{staticClass:"comCol"},[t._v(t._s(s.examTime))]),t._v(" "),a("p",{staticClass:"ctit"},[t._v(t._s(s.qbDesc))])]),t._v(" "),a("div",{staticStyle:{display:"none"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==e,expression:"index==0"}],staticClass:"kaoshiBtn",staticStyle:{width:"190px",color:"#bbb",display:"none"}},[a("span",{staticClass:"default",staticStyle:{color:"#bbb"}},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(t.countNumsM)+"分"+t._s(t.countNumsS)+"秒开始\n\t\t\t\t\t\t\t\t")])])])]:t._e(),t._v(" "),2==t.tabValue?[1==s.examStatus||2==s.examStatus?a("div",[a("h3",{staticClass:"head"},[t._v(t._s(s.qbTitle))]),t._v(" "),a("p",{staticClass:"comCol"},[t._v(t._s(s.examTime))]),t._v(" "),a("p",{staticClass:"ctit"},[t._v(t._s(s.qbDesc))]),t._v(" "),t._m(1,!0)]):t._e(),t._v(" "),null==s.examStatus?a("div",[a("h3",{staticClass:"head"},[t._v(t._s(s.qbTitle))]),t._v(" "),a("p",{staticClass:"comCol"},[t._v(t._s(s.examTime))]),t._v(" "),a("p",{staticClass:"ctit"},[t._v(t._s(s.qbDesc))]),t._v(" "),a("router-link",{attrs:{to:"/TestPaper?qbId="+s.qbId+"&questType="+t.questType}},[t.hasQx("stu:qc:detail")?a("div",{staticClass:"kaoshiBtn"},[a("span",{staticClass:"default"},[t._v("\n\t\t\t\t\t\t\t\t\t\t开始考试\n\t\t\t\t\t\t\t\t\t")])]):t._e()])],1):t._e()]:t._e(),t._v(" "),3==t.tabValue?[t.hasQx("comm:stu:commitExamInfo")?[a("router-link",{attrs:{to:"/AnsderStuDetail?qbId="+s.qbId+"&questType="+t.questType}},[a("h3",{staticClass:"head"},[t._v(t._s(s.qbTitle))]),t._v(" "),a("p",{staticClass:"comCol"},[t._v(t._s(s.examTime))]),t._v(" "),a("p",{staticClass:"ctit"},[t._v(t._s(s.qbDesc))]),t._v(" "),a("div",{staticClass:"kaoshiScore"},[a("span",{staticClass:"default"},[s.score>0?[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(s.score)),a("i",[t._v("分")])]:t._e()],2)])])]:t._e(),t._v(" "),t.hasQx("comm:stu:commitExamInfo")?t._e():[a("h3",{staticClass:"head"},[t._v(t._s(s.qbTitle))]),t._v(" "),a("p",{staticClass:"comCol"},[t._v(t._s(s.examTime))]),t._v(" "),a("p",{staticClass:"ctit"},[t._v(t._s(s.qbDesc))]),t._v(" "),a("div",{staticClass:"kaoshiScore"},[a("span",{staticClass:"default"},[s.score>0?[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(s.score)),a("i",[t._v("分")])]:t._e()],2)])]]:t._e()],2):t._e()])}),t._v(" "),0===t.resData.length?a("NotInfo",{attrs:{notClass:"暂无相关信息",defaultImg:"static/img/not-data-default.png"}}):t._e()],2),t._v(" "),t.hasQx("teach:quest:add")?[0===t.status?a("section",{staticClass:"uploadBtn",on:{click:function(s){t.addTestPaper()}}},[t._m(2)]):t._e()]:t._e()],2)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"kaoshiBtn"},[s("button",{staticClass:"default",staticStyle:{width:"100%",color:"#ccc"},attrs:{disabled:"disabled"}},[this._v("\n\t\t\t\t\t\t\t\t\t\t暂无学生答题\n\t\t\t\t\t\t\t\t\t")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"kaoshiBtn"},[s("span",{staticClass:"default",staticStyle:{color:"#ccc","border-color":"#ccc"}},[this._v("\n\t\t\t\t\t\t\t\t\t已交卷\n\t\t\t\t\t\t\t\t")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"prel"},[s("div",{staticClass:"upBox"},[s("p",[this._v("+")]),this._v(" "),s("a",{staticClass:"itemBtn",staticStyle:{display:"inline-block"},attrs:{href:"javascript:"}},[this._v("新增考核")])])])}]};var u=a("VU/8")(o,l,!1,function(t){a("Q1eC")},null,null);s.default=u.exports}});