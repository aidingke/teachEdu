webpackJsonp([68],{"3R3v":function(e,t){},AoUU:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("exGp"),o=a.n(i),n={name:"TeachTraining",components:{tabNav:a("sUAl").a},data:function(){return{tabValue:Number(sessionStorage.getItem("teachTabNavType"))||1,NavArr:["进行中","历史培训"],nameNumber:6,showAdd:!1,userType:"0",action:"/edu/teach/uploadImg",form:{startTime:"",endTime:"",trainName:"",trainDesc:"",trainImg:""},accessToken:localStorage.getItem("accessToken"),rules:{startTime:[{required:!0,message:"请输入培训开始时间",trigger:"blur"}],endTime:[{required:!0,message:"请输入培训结束时间",trigger:"blur"}],trainName:[{required:!0,message:"请输入培训名称",trigger:"blur"}],trainDesc:[{required:!0,message:"请输入培训描述",trigger:"blur"}],trainImg:[{required:!0,message:"请上传图片",trigger:"blur"}]},resData:[],fileImgUrl:"",dialogVisible:!1,params:{pageNo:1,pageSize:10},show:!0}},methods:{goBack:function(){this.$router.push({name:"TrainExamIndex"}),window.sessionStorage.removeItem("teachTabNavType")},goDetail:function(e,t){this.hasQx("comm:train:detail")?this.$router.push({path:"TrainingDetail",query:{trainId:e,trainStuNum:t,isStudent:!1,isTeacher:!0}}):this.dialog("您无权进行该操作")},openAddInfo:function(){this.showAdd=!0},beforeAvatarUpload:function(e){if(this.hasQx("teach:uploadImg")){var t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type||"image/gif"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("请上传正确的图片格式!"),a||this.$message.error("图片不能大于3M!"),t&&a}this.dialog("您无权进行该操作")},handleRemove:function(e,t){console.log(e,t);var a=this.form.trainImg.split(",");this.form.trainImg=a.filter(function(t,a){return t!==e.response.data.imgName}).join(",")},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleAvatarSuccess:function(e,t){if(1e3!==e.code)return this.$message.error("上传图片失败！！"),!1;this.$message.success("上传图片成功"),""===this.form.trainImg?this.form.trainImg=e.data.imgName:this.form.trainImg+=","+e.data.imgName},updateTabValue:function(e){this.tabValue=e,window.sessionStorage.setItem("teachTabNavType",e),this.getList()},validate:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.TeachTrainAdd()})},TeachTrainAdd:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.form.startTime=e.dayjs(e.form.startTime).format("YYYY-MM-DD"),e.form.endTime=e.dayjs(e.form.endTime).format("YYYY-MM-DD"),t.next=4,e.$axios.TeachTrainAdd(e.form);case 4:1e3===(a=t.sent).code?(e.successMsg("新增培训成功"),e.showAdd=!1,e.getList()):e.dialog(a.message);case 6:case"end":return t.stop()}},t,e)}))()},getList:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return 1===e.tabValue?e.params.trainType="0":e.params.trainType="1",t.next=3,e.$axios.getTeachTrainList(e.params);case 3:if(a=t.sent,e.resData=[],1e3!==a.code){t.next=10;break}a.data.length>0?e.show=!0:e.show=!1,e.resData=a.data,t.next=16;break;case 10:if(e.show=!1,1100!==a.code){t.next=15;break}return t.abrupt("return");case 15:e.dialog(a.message);case 16:case"end":return t.stop()}},t,e)}))()}},mounted:function(){this.userType=localStorage.getItem("userType"),this.getList()},computed:{headers:function(){return{accessToken:localStorage.getItem("accessToken")}}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"TeachTraining"},[a("div",[a("Header",{attrs:{title:"技术培训"},on:{goBack:e.goBack}}),e._v(" "),a("tabNav",{attrs:{tabNavArr:e.NavArr,tabVal:e.tabValue},on:{tabChange:function(t){e.updateTabValue(t)}}})],1),e._v(" "),e.resData&&e.resData.length>0&&e.show?a("div",{staticClass:"passBox box"},e._l(e.resData,function(t,r){return a("div",{key:r,staticClass:"selectBox",on:{click:function(a){e.goDetail(t.trainId,t.trainStuNum)}}},[a("div",{staticClass:"passBox"},[a("h3",{staticClass:"head"},[e._v(e._s(t.trainName))]),e._v(" "),a("p",{staticClass:"comCol"},[e._v(e._s(t.trainTime))]),e._v(" "),a("p",{staticClass:"ctit"},[e._v(e._s(t.trainDesc))]),e._v(" "),a("div",{staticClass:"kaoshiScore"},[a("span",{staticClass:"default"},[e._v("\n\t\t\t\t\t\t\t"+e._s(t.trainStuNum)+"\n\t\t\t\t\t\t\t"),a("p",[e._v("报名人数")])])])])])})):e._e(),e._v(" "),0!==e.resData.length||e.show?e._e():a("NotInfo",{attrs:{notClass:"暂无技术培训列表信息",defaultImg:"static/img/not-data-default.png"}}),e._v(" "),a("el-dialog",{attrs:{title:"新增培训",visible:e.showAdd},on:{"update:visible":function(t){e.showAdd=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"培训时间",required:""}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"startTime"}},[a("el-date-picker",{staticStyle:{border:"1px solid #dcdfe6","border-radius":"4px"},attrs:{span:11,type:"date",placeholder:"选择日期",focus:"blur()"},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:2}},[e._v("至")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"endTime"}},[a("el-date-picker",{staticStyle:{border:"1px solid #dcdfe6","border-radius":"4px"},attrs:{span:11,type:"date",placeholder:"选择日期",focus:"blur()"},model:{value:e.form.endTime,callback:function(t){e.$set(e.form,"endTime",t)},expression:"form.endTime"}})],1)],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"主题",prop:"trainName"}},[a("el-input",{attrs:{maxlength:"36",type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入主题，最多36个字"},model:{value:e.form.trainName,callback:function(t){e.$set(e.form,"trainName",t)},expression:"form.trainName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传图片",prop:"trainImg"}},[a("p",{staticClass:"addTip"},[e._v("*请上传图片，大小限制在3M以内")]),e._v(" "),a("el-upload",{ref:"uploadFile",staticClass:"avatar-uploader",attrs:{headers:e.headers,multiple:!0,action:e.action,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"show-file-list":!0,"on-success":e.handleAvatarSuccess,"list-type":"picture-card","before-upload":e.beforeAvatarUpload,name:"imgFile",data:{imgType:4}}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"trainDesc"}},[a("el-input",{attrs:{maxlength:"36",type:"textarea",autosize:{minRows:3,maxRows:16},placeholder:"请输入描述，最多36个字"},model:{value:e.form.trainDesc,callback:function(t){e.$set(e.form,"trainDesc",t)},expression:"form.trainDesc"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.validate("form")}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.showAdd=!1}}},[e._v("取 消")])],1)],1),e._v(" "),e.hasQx("teach:train:add")?a("section",{staticClass:"uploadBtn",on:{click:e.openAddInfo}},[e._m(0)]):e._e()],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"prel"},[t("div",{staticClass:"upBox"},[t("p",[this._v("+")]),this._v(" "),t("a",{staticClass:"itemBtn",staticStyle:{display:"inline-block"},attrs:{href:"javascript:"}},[this._v("新增培训")])])])}]};var c=a("VU/8")(n,l,!1,function(e){a("3R3v")},null,null);t.default=c.exports}});