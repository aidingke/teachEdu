webpackJsonp([40],{vkGL:function(e,t){},xJsL:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mvHQ"),r=s.n(a),o=s("woOf"),n=s.n(o),i=s("Xxa5"),c=s.n(i),u=s("exGp"),l=s.n(u),g={name:"Login",data:function(){return{user:{userName:"",password:""},errShow:"",nullMsg:!1,loginObject:{},uuid:"",orgId:"",iosFlag:!0,otherMsg:""}},methods:{authority:function(){var e=this;return l()(c.a.mark(function t(){var s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.getPersonPermiss();case 2:1e3===(s=t.sent).code&&e.$store.dispatch("getQx",s.data);case 4:case"end":return t.stop()}},t,e)}))()},loginCallBack:function(){try{this.iosFlag&&(window.location="objc://doFunc/loginCallBack/?username="+this.user.userName+"&password="+this.user.password+"&token="+this.loginObject.data.accessToken)}catch(e){console.log(e,"e")}},submitLogin:function(){var e=this;return l()(c.a.mark(function t(){var s,a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.user.userName||!e.user.password){t.next=19;break}return(s={orgId:e.orgId,userName:e.user.userName,password:e.user.password,deviceMac:e.uuid}).password=e.$md5(s.password).toUpperCase(),t.next=5,e.$axios.getLogin(s);case 5:if(1e3===(a=t.sent).code){t.next=8;break}return t.abrupt("return",e.errShow=a.message);case 8:e.loginObject=n()({},a),e.loginCallBack(),sessionStorage.setItem("userName",e.user.userName),sessionStorage.setItem("password",e.user.password),sessionStorage.setItem("bannerList",r()(e.loginObject.data.bannerList)),localStorage.setItem("accessToken",e.loginObject.data.accessToken),localStorage.setItem("userType",e.loginObject.data.userType),localStorage.setItem("isMac",e.loginObject.data.isMac),e.$store.dispatch("getQx").then(l()(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:"1"===e.loginObject.data.isMac?e.$router.push({path:"/Home"}):"0"===e.loginObject.data.userType?e.$router.push({path:"/BindDevice"}):e.loginObject.data.userType;case 1:case"end":return t.stop()}},t,e)}))),t.next=20;break;case 19:e.nullMsg=!0;case 20:case"end":return t.stop()}},t,e)}))()}},mounted:function(){this.iosFlag=this.isIos(),"undefined"!=sessionStorage.getItem("uuid")&&""!=sessionStorage.getItem("uuid")&&null!=sessionStorage.getItem("uuid")?this.uuid=sessionStorage.getItem("uuid"):"pc"==this.isDevice()?this.uuid="pc":this.uuid="1123","undefined"!=localStorage.getItem("orgId")&&""!=localStorage.getItem("orgId")&&null!=localStorage.getItem("orgId")&&void 0!=localStorage.getItem("orgId")?this.orgId=localStorage.getItem("orgId"):this.orgId="97097851240D4DDA9BCFCF29678B6FFD"},created:function(){console.log(this.isDevice())}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login"},[s("img",{staticClass:"bg-img",attrs:{src:"static/img/binddevice_bg.png"}}),s("div",{staticClass:"login-content"},[s("h3",{staticClass:"login-title"},[e._v(" 登录")]),s("div",{staticClass:"input-box"},[s("el-input",{attrs:{autofocus:"true",type:"text",placeholder:"账号",maxlength:"11",clearable:"clearable"},on:{focus:function(t){e.nullMsg=!1,e.errShow=!1}},model:{value:e.user.userName,callback:function(t){e.$set(e.user,"userName",t)},expression:"user.userName"}}),e._m(0)],1),s("div",{staticClass:"input-box"},[s("el-input",{attrs:{type:"password",placeholder:"密码",clearable:"clearable"},on:{focus:function(t){e.nullMsg=!1,e.errShow=!1}},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),e._m(1)],1),""!=e.errShow?s("div",{staticClass:"err-msg"},[e._v("用户名或密码错误")]):e._e(),e.nullMsg?s("div",{staticClass:"null-msg"},[e._v("账号与密码不能为空")]):e._e(),s("div",{staticClass:"button-submit"},[s("el-button",{attrs:{type:"primary"},on:{click:e.submitLogin}},[e._v("立即登录")])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"icon"},[t("img",{attrs:{src:"static/img/username.png"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"icon"},[t("img",{attrs:{src:"static/img/password.png"}})])}]};var m=s("VU/8")(g,d,!1,function(e){s("vkGL")},null,null);t.default=m.exports}});